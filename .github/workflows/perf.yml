name: Perf

on:
  pull_request:
    branches: ["main"]

permissions:
  contents: read
  pull-requests: write

jobs:
  iai-callgrind:
    name: iai-callgrind PR Bench
    uses: terjekv/github-action-iai-callgrind/.github/workflows/iai-callgrind-pr-bench.yml@91ff329a5b3da51a67af87c02212df074350a608
    with:
      action_ref: 91ff329a5b3da51a67af87c02212df074350a608
      benchmarks_json: >-
        ["evaluate_iai"]
      feature_sets_json: >-
        [
          {"name":"no-obs","features":""},
          {"name":"obs","features":"observability"}
        ]
      regression_threshold_pct: 8
      fail_on_regression: true
