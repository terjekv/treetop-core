name: Perf

on:
  pull_request:
    branches: ["main"]

permissions:
  contents: read
  pull-requests: write

jobs:
  iai-callgrind:
    name: iai-callgrind PR Bench
    uses: terjekv/github-action-iai-callgrind/.github/workflows/iai-callgrind-pr-bench.yml@faf04665fc3a9149409bdceb515cbe6a34dc968a
    with:
      benchmarks_json: >-
        ["evaluate_iai"]
      feature_sets_json: >-
        [
          {"name":"no-obs","features":""},
          {"name":"obs","features":"observability"}
        ]
      regression_threshold_pct: 8
      fail_on_regression: true
